# Excel导出快速指南

## 导出流程（3步完成）

### 📝 第一步：点击导出按钮
点击工具栏的 **💾 导出Excel** 按钮

### 🔀 第二步：选择导出模式
弹出对话框，选择导出方式：

```
┌────────────────────────────────────────┐
│         选择导出模式                    │
├────────────────────────────────────────┤
│ 请选择Excel导出方式：                   │
│                                        │
│ • 追加模式：将数据追加到已有Excel文件    │
│ • 新建模式：创建新的Excel文件          │
│   (如文件存在则自动重命名)              │
│                                        │
│   [是(Y)]  [否(N)]  [取消]             │
└────────────────────────────────────────┘
```

- **点击"是(Y)"** → 追加模式（继续第3a步）
- **点击"否(N)"** → 新建模式（继续第3b步）
- **点击"取消"** → 取消导出

### 📂 第三步：选择文件

#### 3a. 追加模式 - 选择已有文件
```
打开文件选择器
→ 浏览并选择要追加的 .xlsx 文件
→ 点击"打开"
→ 数据自动追加到文件末尾
```

**特点：**
- ✅ 保留原有数据
- ✅ 序号自动连续（从最大序号+1开始）
- ✅ 智能合并表头（区域数量不同时）

#### 3b. 新建模式 - 输入新文件名
```
打开保存对话框
→ 输入文件名（如：ocr结果.xlsx）
→ 点击"保存"
→ 创建新Excel文件
```

**特点：**
- ✅ 文件存在时自动重命名：`ocr结果(1).xlsx`, `ocr结果(2).xlsx`
- ✅ 不会覆盖已有文件
- ✅ Windows风格命名

## 使用场景

### 🔄 适合追加模式的情况
- 分批处理大量文件，需要累积结果
- 多次识别需要合并到同一表格
- 补充之前的导出数据

### 🆕 适合新建模式的情况
- 每次导出独立的结果文件
- 需要保留历史导出记录
- 避免修改已有文件

## 常见问题

**Q1: 追加模式会覆盖原文件吗？**
A: 不会覆盖，会保留所有原有数据，新数据追加到末尾。

**Q2: 新建模式选择已存在的文件名会怎样？**
A: 自动生成新文件名，添加序号如 `(1)`, `(2)`，不会覆盖。

**Q3: 追加时如果区域数量不同怎么办？**
A: 自动使用最大区域数作为表头，数据较少的行会自动补空。

**Q4: 可以取消导出吗？**
A: 可以，在任何对话框点击"取消"即可。

## 示例

### 示例1：分批导出并累积
```
第1次：导出10个文件 → 选择"否"新建 → 保存为 result.xlsx
第2次：导出15个文件 → 选择"是"追加 → 选择 result.xlsx
第3次：导出8个文件  → 选择"是"追加 → 选择 result.xlsx

最终：result.xlsx 包含33条记录，序号1-33
```

### 示例2：每次独立保存
```
第1次：导出数据 → 选择"否"新建 → 保存为 result.xlsx
第2次：导出数据 → 选择"否"新建 → 保存为 result.xlsx
       → 自动生成 result(1).xlsx
第3次：导出数据 → 选择"否"新建 → 保存为 result.xlsx
       → 自动生成 result(2).xlsx

最终：3个独立文件，各自包含一次导出的数据
```

## 快捷提示

💡 **如果不确定选哪个模式：**
- 想累积结果 → 选"是"（追加）
- 想独立保存 → 选"否"（新建）

💡 **Excel文件被占用怎么办？**
- 关闭打开该Excel的其他程序
- 或者选择新建模式导出到新文件

💡 **想要合并多个导出文件？**
- 打开第一个文件作为基础
- 依次用追加模式将其他文件的数据合并进来
